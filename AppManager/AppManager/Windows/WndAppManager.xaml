<Window
	xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
	xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
	xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
	xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
	xmlns:am="clr-namespace:AppManager"
	x:Class="AppManager.WndAppManager"
	x:Name="AppsManagerWindow"
	Title="{Binding Source={x:Static am:Strings.APP_MANAGER}}"
	Width= "375" Height="480"  mc:Ignorable="d" WindowStartupLocation="CenterOwner" Icon="/AppManager;component/Resources/Window.png" ShowInTaskbar="False" MinWidth="250" MinHeight="300">
	<Window.Resources>
		<Style x:Key="AppItemStyle" TargetType="ListViewItem">
			<Style.Resources>
				<SolidColorBrush x:Key="{x:Static SystemColors.HighlightBrushKey}" Color="#FFB0CCF7"/>
				<SolidColorBrush x:Key="{x:Static SystemColors.ControlBrushKey}" Color="#FFDFDFDF"/>
			</Style.Resources>
		</Style>
		<Style x:Key="AppTypeItemStyle" TargetType="ListBoxItem">
			<Style.Resources>
				<SolidColorBrush x:Key="{x:Static SystemColors.HighlightBrushKey}" Color="#FFB0CCF7"/>
				<SolidColorBrush x:Key="{x:Static SystemColors.ControlBrushKey}" Color="#FFDFDFDF"/>
			</Style.Resources>
		</Style>
		<!--<Style x:Key="AppItemText" TargetType="TextBox">
			<Style.Resources>
				<SolidColorBrush x:Key="{x:Static SystemColors.HighlightBrushKey}" Color="#FFB0CCF7"/>
				<SolidColorBrush x:Key="{x:Static SystemColors.ControlBrushKey}" Color="#FFDFDFDF"/>
				<SolidColorBrush x:Key="{x:Static SystemColors}" Color="#FFDFDFDF"/>
			</Style.Resources>
		</Style>-->
		<DataTemplate x:Key="CheckCell">
			<StackPanel Orientation="Horizontal">
				<CheckBox Name="SelectedCheckBox" IsChecked="{Binding Path=Checked}" />
			</StackPanel>
		</DataTemplate>
		<!--<DataTemplate x:Key="ImageCell">
			<StackPanel Orientation="Horizontal">
				<Image Width="24" Height="24" Stretch="UniformToFill" Source="{Binding Path=AppImage}" />
			</StackPanel>
		</DataTemplate>-->
		<!--<DataTemplate x:Key="AppInfo">
			<StackPanel Orientation="Vertical">
				<TextBlock Text="{Binding Path=AppName}"/>
				<TextBlock Text="{Binding Path=AppPath}"/>
			</StackPanel>
		</DataTemplate>-->
		<DataTemplate x:Key="AppTypeInfo">
			<StackPanel Orientation="Vertical" Margin="4,2,0,2">
				<TextBlock Text="{Binding Path=AppTypeName}" FontSize="12"/>
				<TextBlock Text="{Binding Path=AppTypeInfo}" FontSize="10" Foreground="#FF7A7979"/>
			</StackPanel>
		</DataTemplate>
		<!--<DataTemplate x:Key="EditableAppInfo">
			<Grid Name="GridT" Height="40" Background="Cyan">
				<Grid.RowDefinitions>
					<RowDefinition Height="50*" />
					<RowDefinition Height="50*" />
				</Grid.RowDefinitions>
				<Grid.ColumnDefinitions>
					<ColumnDefinition Width="50*" />
					<ColumnDefinition Width="28" />
				</Grid.ColumnDefinitions>
				<TextBox Grid.ColumnSpan="2" Text="{Binding Path=AppName, Mode=TwoWay}" BorderBrush="{x:Null}" Width="250" Background="{x:Null}"/>
				<TextBlock Name="AppItemPath" Grid.Row="1" Text="{Binding Path=AppPath, Mode=TwoWay}" Margin="4,4,0,0"/>
				<Button Name="AppItemPathSelect" Content="..." Grid.Row="1" Grid.Column="1" Click="AppPathSelect_Click" />
			</Grid>
		</DataTemplate>-->
		<DataTemplate x:Key="EditableAppInfo">
			<Border Name="BorderT" BorderThickness="0,0,0,1" BorderBrush="#FFADADAD" Padding="0,0,0,4">
					  <!--Width="{Binding (FrameworkElement.ActualWidth), RelativeSource={RelativeSource Mode= AncestorType=ScrollContentPresenter}}">-->
				<Grid Name="GridT">
					<!--<Grid.Width>
						<Binding Path="Width" Mode="OneWay">
							<Binding.RelativeSource>
								<RelativeSource Mode="FindAncestor" AncestorType="ListBox"/>
							</Binding.RelativeSource>
						</Binding>
					</Grid.Width>-->
					<Grid.RowDefinitions>
						<RowDefinition Height="50*" />
						<RowDefinition Height="50*" />
					</Grid.RowDefinitions>
					<Grid.ColumnDefinitions>
						<ColumnDefinition Width="40" MaxWidth="40" />
						<ColumnDefinition Width="*" />
						<ColumnDefinition Width="28" MaxWidth="28" />
					</Grid.ColumnDefinitions>
					<Image Grid.RowSpan="2" Source="{Binding Path=AppImage}" Width="24" Height="24" />
					<TextBox 
						Grid.Column="1" 
						Grid.ColumnSpan="2" 
						Text="{Binding Path=AppName, Mode=TwoWay}" 
						BorderBrush="{x:Null}" 
						HorizontalAlignment="Stretch" 
						GotFocus="TextBox_GotFocus">
						<TextBox.Background>
							<Binding Path="Background">
								<Binding.RelativeSource>
									<RelativeSource Mode="FindAncestor" AncestorType="ScrollContentPresenter"/>
								</Binding.RelativeSource>
							</Binding>
						</TextBox.Background>
					</TextBox>
					<!--<TextBlock TextTrimming="WordEllipsis" Grid.Column="1" x:Name="AppItemPath" Grid.Row="1" Text="{Binding Path=AppPath, Mode=TwoWay}" Margin="4,4,0,0" HorizontalAlignment="Left"/>-->
					<TextBox 
						Grid.Column="1" 
						Grid.Row="1"
						x:Name="AppItemPath" 
						Text="{Binding Path=ExecPath, Mode=TwoWay}" 
						Margin="0,1,0,0" 
						BorderBrush="{x:Null}" 
						HorizontalAlignment="Stretch" 
						GotFocus="TextBox_GotFocus" >
						<TextBox.Background>
							<Binding Path="Background">
								<Binding.RelativeSource>
									<RelativeSource Mode="FindAncestor" AncestorType="ScrollContentPresenter"/>
								</Binding.RelativeSource>
							</Binding>
						</TextBox.Background>
					</TextBox>
					<Button x:Name="AppItemPathSelect" Content="..." Grid.Row="1" Grid.Column="2" Width="28" Click="AppPathSelect_Click" />
				</Grid>
			</Border>
		</DataTemplate>
		<DataTemplate x:Key="SemiEditableAppInfo">
			<Border Name="BorderT" BorderThickness="0,0,0,1" BorderBrush="#FFADADAD" Padding="0,0,0,4">
				<Border.Width>
					<Binding Path="ActualWidth">
						<Binding.RelativeSource>
							<RelativeSource Mode="FindAncestor" AncestorType="ScrollContentPresenter"/>
						</Binding.RelativeSource>
					</Binding>
				</Border.Width>
				<Grid Name="GridT">
					<Grid.RowDefinitions>
						<RowDefinition Height="50*" />
						<RowDefinition Height="50*" />
					</Grid.RowDefinitions>
					<Grid.ColumnDefinitions>
						<ColumnDefinition Width="40" />
						<ColumnDefinition Width="*" />
					</Grid.ColumnDefinitions>
					<Image Grid.RowSpan="2" Source="{Binding Path=AppImage}" Width="24" Height="24" />
					<TextBox Grid.Column="1" Text="{Binding Path=AppName, Mode=TwoWay}" BorderBrush="{x:Null}" Width="Auto" Background="{x:Null}" HorizontalAlignment="Stretch" GotFocus="ScanTextBox_GotFocus" />
					<TextBlock Grid.Column="1" x:Name="AppItemPath" Grid.Row="1" Text="{Binding Path=ExecPath, Mode=OneWay}" Margin="4,4,0,0" HorizontalAlignment="Left"/>
				</Grid>
			</Border>
		</DataTemplate>
		<!--</SnippetCheckBoxDataTemplate>-->
	</Window.Resources>
	
	<Grid x:Name="LayoutRoot">
		<Grid.RowDefinitions>
			<RowDefinition Height="*"/>
			<RowDefinition Height="44"/>
		</Grid.RowDefinitions>
		<TabControl IsSynchronizedWithCurrentItem="True">
			<TabItem Header="{Binding Source={x:Static am:Strings.APP_TYPES}}">
				<Grid>
					<Grid.RowDefinitions>
						<RowDefinition Height="44" />
						<RowDefinition Height="306.723*" />
						<RowDefinition Height="8" />
					</Grid.RowDefinitions>
					<ListBox 
						ItemTemplate="{StaticResource AppTypeInfo}"
						ItemContainerStyle="{StaticResource AppTypeItemStyle}"
						IsSynchronizedWithCurrentItem="True" 
						x:Name="AppTypes" Margin="8,0,8,0" Grid.Row="1" />
					<Grid>
						<Grid.ColumnDefinitions>
							<ColumnDefinition Width="Auto" />
							<ColumnDefinition Width="100*" />
                            <ColumnDefinition Width="Auto" MinWidth="20" />
                            <ColumnDefinition Width="Auto" MinWidth="20" />
							<ColumnDefinition Width="Auto" MinWidth="20" />
							<ColumnDefinition Width="Auto" MinWidth="24" />
						</Grid.ColumnDefinitions>
						<Label 
							Margin="8,9,0,6" Content="{Binding Source={x:Static am:Strings.APP_TYPE_NAME}}" 
							x:Name="AppTypeLabel" HorizontalAlignment="Left"/>
						<TextBox
							Text="{Binding Path=SelectedItem.AppTypeName, ElementName=AppTypes, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" 
							TextWrapping="Wrap" 
							x:Name="AppTypeName" 
							Grid.Column="1" 
							Margin="4,12" />
                        <Button Width="24" x:Name="BtnAppTypeUp" Margin="4,12,4,12" Grid.Column="2" Click="BtnAppTypeUp_Click">
                            <Image Source="/AppManager;component/Resources/up_16.png" />
                        </Button>
                        <Button Width="24" x:Name="BtnAppTypeDown" Margin="4,12,4,12" Grid.Column="3" Click="BtnAppTypeDown_Click">
                            <Image Source="/AppManager;component/Resources/down_16.png" />
                        </Button>
                        <Button Width="24" Content="+" x:Name="BtnAddAppType" Click="BtnAddAppType_Click" Margin="4,12,4,12" Grid.Column="4" />
						<Button Width="24" Content="-" x:Name="BtnRemoveAppType" Click="BtnRemoveAppType_Click" Grid.Column="5" HorizontalAlignment="Left" Margin="0,12,8,12" />
					</Grid>
				</Grid>
			</TabItem>
			<TabItem Header="{Binding Source={x:Static am:Strings.APPLICATIONS}}">
				<Grid Height="Auto" Width="Auto" Name="AppTypesApp">
					<Grid.RowDefinitions>
						<RowDefinition Height="44" />
						<RowDefinition Height="306.723*" />
						<RowDefinition Height="8"/>
					</Grid.RowDefinitions>
					<ListBox
						Grid.Row="1"
						Margin="8,0"
						Name="AppList" 
						ItemsSource="{Binding ElementName=AppTypeSelector, Path=SelectedItem.AppInfos}"
						HorizontalContentAlignment="Stretch"
						IsSynchronizedWithCurrentItem="True"
						ItemTemplate="{StaticResource EditableAppInfo}"
						ItemContainerStyle="{StaticResource AppTypeItemStyle}"
						ScrollViewer.HorizontalScrollBarVisibility="Disabled">
						<ListBox.ItemsPanel>
							<ItemsPanelTemplate>
								<VirtualizingStackPanel 
									 Orientation="Vertical" 
									 IsItemsHost="True"
									 Width="{Binding Path=ActualWidth, 
											RelativeSource={RelativeSource Mode=FindAncestor, 
											AncestorType= {x:Type ScrollContentPresenter}}}" />
							</ItemsPanelTemplate>
						</ListBox.ItemsPanel>
					</ListBox>
					<ComboBox 
						DisplayMemberPath="AppTypeName" 
						Margin="8,12,122,12.723" 
						Name="AppTypeSelector" SelectedIndex="0" />
                    <Button HorizontalAlignment="Right" Margin="0,12,92,12" Name="BtnAppUp" VerticalAlignment="Top" Width="24" Click="BtnAppUp_Click">
                        <Image Source="/AppManager;component/Resources/up_16.png" />
                    </Button>
                    <Button HorizontalAlignment="Right" Margin="0,12,64,12" Name="BtnAppDown" VerticalAlignment="Top" Width="24" Click="BtnAppDown_Click">
                        <Image Source="/AppManager;component/Resources/down_16.png" />
                    </Button>
					<Button HorizontalAlignment="Right" Margin="0,12,36,12" Name="BtnAddApp" VerticalAlignment="Top" Width="24" Click="BtnAddApp_Click">+</Button>
					<Button HorizontalAlignment="Right" Margin="0,12,8,12" Name="BtnRemoveApp" VerticalAlignment="Top" Width="24" Click="BtnRemoveApp_Click">-</Button>
				</Grid>
			</TabItem>
			<TabItem Header="{Binding Source={x:Static am:Strings.SEARCH}}">
				<Grid Height="Auto" Width="Auto">
					<Grid.RowDefinitions>
						<RowDefinition Height="76" />
						<RowDefinition Height="293.723*" />
						<RowDefinition Height="8" />
					</Grid.RowDefinitions>
					<Grid>
						<Grid.RowDefinitions>
							<RowDefinition Height="38" />
							<RowDefinition Height="38" />
						</Grid.RowDefinitions>
						<Grid.ColumnDefinitions>
							<ColumnDefinition Width="Auto" />
							<ColumnDefinition Width="100*" />
							<ColumnDefinition Width="Auto" />
							<ColumnDefinition Width="Auto" />
							<ColumnDefinition Width="Auto" />
						</Grid.ColumnDefinitions>
						<Label 
							Margin="8,6,0,1.7" 
							Name="label1" 
							VerticalContentAlignment="Center" 
							Content="{Binding Source={x:Static am:Strings.ADD_TO_TYPE}}" />
						<ComboBox 
							DisplayMemberPath="AppTypeName" 
							Margin="4,12,8,6" 
							Name="AppScanType" 
							SelectedIndex="0" 
							Grid.Column="1" 
							Grid.ColumnSpan="4" />
						
						<TextBox 
							Grid.Row="1"
							Margin="8,6,4,12" 
							Name="TxtFolder" Grid.ColumnSpan="2" />
						<Button 
							Grid.Row="1"
							MinWidth="24"
							Margin="0,6,4,12" Name="BtnFolder" Click="BtnFolder_Click" Grid.Column="2">...</Button>
						<Button 
							Grid.Row="1" 
							Margin="0,6,4,12" 
							Name="_BtnSearch" Click="BtnSearch_Click" Content="{Binding Source={x:Static am:Strings.SCAN}}" Grid.Column="3" />
						<Button 
							Grid.Row="1" 
							Width="24"
							Margin="0,6,8,12" 
							Name="BtnAddScan" 
							Click="BtnAddScan_Click" 
							Grid.Column="4">+</Button>
					</Grid>
					<ListView 
						Margin="8,0" Name="AppScanList" Grid.Row="1" 
						HorizontalContentAlignment="Stretch"
						ItemContainerStyle="{StaticResource AppTypeItemStyle}">
						<ListView.View>
							<GridView AllowsColumnReorder="false" ColumnHeaderToolTip="Employee Information">
								<GridViewColumn CellTemplate="{StaticResource CheckCell}" Width="26"/>
								<GridViewColumn CellTemplate="{StaticResource SemiEditableAppInfo}" Header="{Binding Source={x:Static am:Strings.APPLICATION}}" Width="300"/>
							</GridView>
						</ListView.View>
					</ListView>
				</Grid>
			</TabItem>
		</TabControl>
		<Button 
			Content="{Binding Source={x:Static am:Strings.OK}}"
			Margin="0,8,94,8" 
			Grid.Row="1" 
			Width="80" 
			HorizontalAlignment="Right" 
			x:Name="BtnOK" 
			Click="BtnOK_Click" />
		<Button 
			Content="{Binding Source={x:Static am:Strings.CANCEL}}"
			HorizontalAlignment="Right" Margin="0,8,8,8" Width="80" Grid.Row="1" Name="BtnCancel" Click="BtnCancel_Click" />
	</Grid>
</Window>