<Window
	xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
	xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
	xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
	xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
	x:Class="AppManager.WndAppManager"
	x:Name="AppsManagerWindow"
	Title="Manger"
	Width= "375" Height="480"  mc:Ignorable="d" WindowStartupLocation="CenterOwner" Icon="/AppManager;component/Resources/Window.png" ShowInTaskbar="False" MinWidth="250" MinHeight="300">
	<Window.Resources>
		<Style x:Key="AppItemStyle" TargetType="ListViewItem">
			<Style.Resources>
				<SolidColorBrush x:Key="{x:Static SystemColors.HighlightBrushKey}" Color="#FFB0CCF7"/>
				<SolidColorBrush x:Key="{x:Static SystemColors.ControlBrushKey}" Color="#FFDFDFDF"/>
			</Style.Resources>
		</Style>
		<Style x:Key="AppTypeItemStyle" TargetType="ListBoxItem">
			<Style.Resources>
				<SolidColorBrush x:Key="{x:Static SystemColors.HighlightBrushKey}" Color="#FFB0CCF7"/>
				<SolidColorBrush x:Key="{x:Static SystemColors.ControlBrushKey}" Color="#FFDFDFDF"/>
			</Style.Resources>
		</Style>
		<!--<Style x:Key="AppItemText" TargetType="TextBox">
			<Style.Resources>
				<SolidColorBrush x:Key="{x:Static SystemColors.HighlightBrushKey}" Color="#FFB0CCF7"/>
				<SolidColorBrush x:Key="{x:Static SystemColors.ControlBrushKey}" Color="#FFDFDFDF"/>
				<SolidColorBrush x:Key="{x:Static SystemColors}" Color="#FFDFDFDF"/>
			</Style.Resources>
		</Style>-->
		<DataTemplate x:Key="CheckCell">
			<StackPanel Orientation="Horizontal">
				<CheckBox Name="SelectedCheckBox" IsChecked="{Binding Path=Checked}" />
			</StackPanel>
		</DataTemplate>
		<!--<DataTemplate x:Key="ImageCell">
			<StackPanel Orientation="Horizontal">
				<Image Width="24" Height="24" Stretch="UniformToFill" Source="{Binding Path=AppImage}" />
			</StackPanel>
		</DataTemplate>-->
		<!--<DataTemplate x:Key="AppInfo">
			<StackPanel Orientation="Vertical">
				<TextBlock Text="{Binding Path=AppName}"/>
				<TextBlock Text="{Binding Path=AppPath}"/>
			</StackPanel>
		</DataTemplate>-->
		<DataTemplate x:Key="AppTypeInfo">
			<StackPanel Orientation="Vertical" Margin="4,2,0,2">
				<TextBlock Text="{Binding Path=AppTypeName}" FontSize="12"/>
				<TextBlock Text="{Binding Path=AppTypeInfo}" FontSize="10" Foreground="#FF7A7979"/>
			</StackPanel>
		</DataTemplate>
		<!--<DataTemplate x:Key="EditableAppInfo">
			<Grid Name="GridT" Height="40" Background="Cyan">
				<Grid.RowDefinitions>
					<RowDefinition Height="50*" />
					<RowDefinition Height="50*" />
				</Grid.RowDefinitions>
				<Grid.ColumnDefinitions>
					<ColumnDefinition Width="50*" />
					<ColumnDefinition Width="28" />
				</Grid.ColumnDefinitions>
				<TextBox Grid.ColumnSpan="2" Text="{Binding Path=AppName, Mode=TwoWay}" BorderBrush="{x:Null}" Width="250" Background="{x:Null}"/>
				<TextBlock Name="AppItemPath" Grid.Row="1" Text="{Binding Path=AppPath, Mode=TwoWay}" Margin="4,4,0,0"/>
				<Button Name="AppItemPathSelect" Content="..." Grid.Row="1" Grid.Column="1" Click="AppPathSelect_Click" />
			</Grid>
		</DataTemplate>-->
		<DataTemplate x:Key="EditableAppInfo">
			<Border Name="BorderT" BorderThickness="0,0,0,1" BorderBrush="#FFADADAD" Padding="0,0,0,4">
					  <!--Width="{Binding (FrameworkElement.ActualWidth), RelativeSource={RelativeSource Mode= AncestorType=ScrollContentPresenter}}">-->
				<Grid Name="GridT">
					<!--<Grid.Width>
						<Binding Path="Width" Mode="OneWay">
							<Binding.RelativeSource>
								<RelativeSource Mode="FindAncestor" AncestorType="ListBox"/>
							</Binding.RelativeSource>
						</Binding>
					</Grid.Width>-->
					<Grid.RowDefinitions>
						<RowDefinition Height="50*" />
						<RowDefinition Height="50*" />
					</Grid.RowDefinitions>
					<Grid.ColumnDefinitions>
						<ColumnDefinition Width="40" MaxWidth="40" />
						<ColumnDefinition Width="*" />
						<ColumnDefinition Width="28" MaxWidth="28" />
					</Grid.ColumnDefinitions>
					<Image Grid.RowSpan="2" Source="{Binding Path=AppImage}" Width="24" Height="24" />
					<TextBox 
						Grid.Column="1" 
						Grid.ColumnSpan="2" 
						Text="{Binding Path=AppName, Mode=TwoWay}" 
						BorderBrush="{x:Null}" 
						HorizontalAlignment="Stretch" 
						GotFocus="TextBox_GotFocus">
						<TextBox.Background>
							<Binding Path="Background">
								<Binding.RelativeSource>
									<RelativeSource Mode="FindAncestor" AncestorType="ScrollContentPresenter"/>
								</Binding.RelativeSource>
							</Binding>
						</TextBox.Background>
					</TextBox>
					<!--<TextBlock TextTrimming="WordEllipsis" Grid.Column="1" x:Name="AppItemPath" Grid.Row="1" Text="{Binding Path=AppPath, Mode=TwoWay}" Margin="4,4,0,0" HorizontalAlignment="Left"/>-->
					<TextBox 
						Grid.Column="1" 
						Grid.Row="1"
						x:Name="AppItemPath" 
						Text="{Binding Path=ExecPath, Mode=TwoWay}" 
						Margin="0,1,0,0" 
						BorderBrush="{x:Null}" 
						HorizontalAlignment="Stretch" 
						GotFocus="TextBox_GotFocus" >
						<TextBox.Background>
							<Binding Path="Background">
								<Binding.RelativeSource>
									<RelativeSource Mode="FindAncestor" AncestorType="ScrollContentPresenter"/>
								</Binding.RelativeSource>
							</Binding>
						</TextBox.Background>
					</TextBox>
					<Button x:Name="AppItemPathSelect" Content="..." Grid.Row="1" Grid.Column="2" Width="28" Click="AppPathSelect_Click" />
				</Grid>
			</Border>
		</DataTemplate>
		<DataTemplate x:Key="SemiEditableAppInfo">
			<Border Name="BorderT" BorderThickness="0,0,0,1" BorderBrush="#FFADADAD" Padding="0,0,0,4">
				<Border.Width>
					<Binding Path="ActualWidth">
						<Binding.RelativeSource>
							<RelativeSource Mode="FindAncestor" AncestorType="ScrollContentPresenter"/>
						</Binding.RelativeSource>
					</Binding>
				</Border.Width>
				<Grid Name="GridT">
					<Grid.RowDefinitions>
						<RowDefinition Height="50*" />
						<RowDefinition Height="50*" />
					</Grid.RowDefinitions>
					<Grid.ColumnDefinitions>
						<ColumnDefinition Width="40" />
						<ColumnDefinition Width="*" />
					</Grid.ColumnDefinitions>
					<Image Grid.RowSpan="2" Source="{Binding Path=AppImage}" Width="24" Height="24" />
					<TextBox Grid.Column="1" Text="{Binding Path=AppName, Mode=TwoWay}" BorderBrush="{x:Null}" Width="Auto" Background="{x:Null}" HorizontalAlignment="Stretch" GotFocus="ScanTextBox_GotFocus" />
					<TextBlock Grid.Column="1" x:Name="AppItemPath" Grid.Row="1" Text="{Binding Path=ExecPath, Mode=OneWay}" Margin="4,4,0,0" HorizontalAlignment="Left"/>
				</Grid>
			</Border>
		</DataTemplate>
		<!--</SnippetCheckBoxDataTemplate>-->
	</Window.Resources>
	
	<Grid x:Name="LayoutRoot">
		<Grid.RowDefinitions>
			<RowDefinition Height="*"/>
			<RowDefinition Height="44"/>
		</Grid.RowDefinitions>
		<TabControl IsSynchronizedWithCurrentItem="True">
			<TabItem Header="Типы приложений">
				<Grid>
					<Grid.RowDefinitions>
						<RowDefinition Height="44" />
						<RowDefinition Height="306.723*" />
						<RowDefinition Height="8" />
					</Grid.RowDefinitions>
					<ListBox 
						ItemTemplate="{StaticResource AppTypeInfo}"
						ItemContainerStyle="{StaticResource AppTypeItemStyle}"
						IsSynchronizedWithCurrentItem="True" 
						x:Name="AppTypes" Margin="8,0,6,0" Grid.Row="1" />
					<TextBox Margin="86,13,74,10" Text="{Binding ElementName=AppTypes, Path=SelectedItem.AppTypeName, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" TextWrapping="Wrap" x:Name="AppTypeName"/>
					<Label HorizontalAlignment="Left" Margin="8,12,0,9" Width="78" Content="Имя группы" x:Name="AppTypeLabel"/>
					<Button HorizontalAlignment="Right" Margin="0,11.723,39,12" Width="29" Content="+" Name="BtnAddAppType" Click="BtnAddAppType_Click" />
					<Button HorizontalAlignment="Right" Margin="0,12,6,12" Width="29" Content="-" Name="BtnRemoveAppType" Click="BtnRemoveAppType_Click" />
				</Grid>
			</TabItem>
			<TabItem Header="Приложения">
				<Grid Height="Auto" Width="Auto" Name="AppTypesApp">
					<Grid.RowDefinitions>
						<RowDefinition Height="350.723*" />
						<RowDefinition Height="8" />
					</Grid.RowDefinitions>
					<ListBox
						Margin="8,37,8,0" Name="AppList" 
						ItemsSource="{Binding ElementName=AppTypeSelector, Path=SelectedItem.AppInfos}"
						HorizontalContentAlignment="Stretch"
						IsSynchronizedWithCurrentItem="True"
						ItemTemplate="{StaticResource EditableAppInfo}"
						ItemContainerStyle="{StaticResource AppTypeItemStyle}"
						ScrollViewer.HorizontalScrollBarVisibility="Disabled">
						<ListBox.ItemsPanel>
							<ItemsPanelTemplate>
								<VirtualizingStackPanel 
									 Orientation="Vertical" 
									 IsItemsHost="True"
									 Width="{Binding Path=ActualWidth, 
											RelativeSource={RelativeSource Mode=FindAncestor, 
											AncestorType= {x:Type ScrollContentPresenter}}}" />
							</ItemsPanelTemplate>
						</ListBox.ItemsPanel>
					</ListBox>
					<ComboBox DisplayMemberPath="AppTypeName" Height="21" Margin="8,10,74,0" Name="AppTypeSelector" VerticalAlignment="Top" SelectedIndex="0" />
					<Button Height="21" HorizontalAlignment="Right" Margin="0,10,39,0" Name="BtnAddApp" VerticalAlignment="Top" Width="29" Click="BtnAddApp_Click">+</Button>
					<Button Height="21" HorizontalAlignment="Right" Margin="0,10,8,0" Name="BtnRemoveApp" VerticalAlignment="Top" Width="29" Click="BtnRemoveApp_Click">-</Button>
				</Grid>
			</TabItem>
			<TabItem Header="Поиск">
				<Grid Height="Auto" Width="Auto">
					<Grid.RowDefinitions>
						<RowDefinition Height="65" />
						<RowDefinition Height="293.723*" />
						<RowDefinition Height="8" />
					</Grid.RowDefinitions>
					<TextBox Margin="8,0,156,9" Name="TxtFolder" Height="23" VerticalAlignment="Bottom" />
					<Button Margin="0,0,112.221,8.991" Name="BtnFolder" HorizontalAlignment="Right" Width="37" Click="BtnFolder_Click" Height="23" VerticalAlignment="Bottom">...</Button>
					<ListView 
						Margin="8,0" Name="AppScanList" Grid.Row="1" 
						HorizontalContentAlignment="Stretch"
						ItemContainerStyle="{StaticResource AppTypeItemStyle}">
						<ListView.View>
							<GridView AllowsColumnReorder="false" ColumnHeaderToolTip="Employee Information">
								<GridViewColumn CellTemplate="{StaticResource CheckCell}" Width="26"/>
								<GridViewColumn CellTemplate="{StaticResource SemiEditableAppInfo}" Header="Путь" Width="300"/>
							</GridView>
						</ListView.View>
					</ListView>
					<Button HorizontalAlignment="Right" Margin="0,0,50.949,8.991" Name="_BtnSearch" Width="55.476" Click="BtnSearch_Click" Height="23" VerticalAlignment="Bottom">Искать</Button>
					<Button HorizontalAlignment="Right" Margin="0,0,8,8.991" Name="BtnAddScan" Width="37" Click="BtnAddScan_Click" Height="23.021" VerticalAlignment="Bottom">+</Button>
					<ComboBox DisplayMemberPath="AppTypeName" Height="21" Margin="114.534,6,8,0" Name="AppScanType" SelectedIndex="0" VerticalAlignment="Top" />
					<Label HorizontalAlignment="Left" Margin="8,6,0,0" Name="label1" Width="100.4" Height="24.8" VerticalAlignment="Top" VerticalContentAlignment="Center">Добавлять к типу</Label>
				</Grid>
			</TabItem>
		</TabControl>
		<Button Margin="0,8,94,8" Content="OK" Grid.Row="1" Width="80" HorizontalAlignment="Right" x:Name="BtnOK" Click="BtnOK_Click" />
		<Button HorizontalAlignment="Right" Margin="0,8,8,8" Width="80" Content="Отмена" Grid.Row="1" Name="BtnCancel" Click="BtnCancel_Click" />
	</Grid>
</Window>